---
title: "More information"
author: "Jiaqi Li and Mackie Zhou"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: kable
---

<!--
Comments in HTML are like this! 
-->

# SECTION NAME

Write your "more information" section here.

## Subsection name

Write a second `more_info.html` page going more in-depth for people who want more details. In should have

1. Between 2-3 more visualizations.
1. No more than 500 words of text

```{r, echo = FALSE}
# load packages
library(tidyverse)
```

```{r, echo = FALSE}
# read the ecudational attainment df into R
Edu_complete <- read_csv("Estimate_Educational_attainment_2017.csv")

# read the suicide df into R
suicide_by_state <- read_csv("Suicide_Mortality_by_State.csv")

# read the 50 state names&codes df into R
State_names <- read_csv("50State_names_and_codes.csv")

```

```{r, echo = FALSE, fig.height = 15, fig.width = 12}
# select only the state names and the percentages
Edu_percent <- Edu_complete %>%
  select(State, contains("Percent")) %>% 
  select(-(contains("MOE"))) %>% 
  pivot_longer(names_to = "Education", 
               values_to = "Percentage", 
               cols = -State)
  # rename(Less than high school graduate = Less than high school graduate - Percent,
  #        High school graduate or equivalent = High school graduate \(includes equivalency\) - Percent,
  #        Some college or associate\'s degree= Some college or associate\'s degree - Percent,
  #        Bachelor\'s degree or higher - Percent)

# Edu_percent_1 <- Edu_percent %>% 
#   filter(State %in% c("Alabama", "Alaska", "Arizona", "Arkansas",
#                       "California", "Colorado", "Connecticut", "Delaware",
#                       "Florida", "Georgia",
#                       "Idaho", "Hawaii", "Illinois"))
# 
# Edu_percent_2 <- Edu_percent %>% 
#   filter(State %in% c("Indiana", "Iowa", 
#                       "Kansas", "Kentucky", "Louisiana",
#                       "Maine", "Maryland", "Massachusetts", "Michigan",
#                       "Minnesota", "Mississippi", "Missouri", "Montana"))
# 
# Edu_percent_3 <- Edu_percent %>% 
#   filter(State %in% c("Nebraska", "Nevada", "New Hampshire",
#                       "New Jersey", "New Mexico", "New York",
#                       "North Carolina", "North Dakota", "Ohio", "Oklahoma",
#                       "Oregon", "Pennsylvania", "Rhode Island"))
# 
# Edu_percent_4 <- Edu_percent %>% 
#   filter(State %in% c("South Carolina", "South Dakota", "Tennessee",
#                       "Texas", "Utah", "Vermont", "Virginia", "Washington",
#                       "West Virginia", "Wisconsin", "Wyoming",
#                       "District of Columbia", "Puerto Rico"))

# horizontal stacked bar graph of educational attainment by state
ggplot(data = Edu_percent, 
       mapping = aes(x = factor(State, levels = rev(levels(factor(State)))),
                     y = Percentage, 
                     fill = Education)) +
  geom_bar(position="fill", 
           stat="identity",
           width = 0.7) +
  scale_y_continuous(labels = scales::percent) +
  labs(x = "State",
       y = "Percentage",
       fill = "Educational Attainment",
       title = "Estimate Educational Attainment of People Aged 18-24 by State in 2017") +
  coord_flip() +
  theme(text = element_text(size=15))

```

```{r, echo = FALSE, fig.height = 15, fig.width = 12}
# select only data in 2017 and optimize the df
suicide_2017 <- suicide_by_state %>% 
  filter(YEAR=="2017") %>% 
  left_join(State_names, by = c("STATE" = "Code")) %>% 
  rename(CODE = STATE,
         STATE = State) %>%
  select(STATE, CODE, DEATHS, RATE)

# horizontal bar graph of suicide rate by state
ggplot(data = suicide_2017, 
       mapping = aes(x = factor(STATE, levels = rev(levels(factor(STATE)))),
                     y = RATE)) +
  geom_col(fill="CornflowerBlue",
           width = 0.75) +
  # scale_y_continuous(labels = scales::percent) +
  labs(x = "State",
       y = "Suicide Death Rate(%)",
       title = "Suicide Death Rate by State in 2017") +
  coord_flip() +
  theme(text = element_text(size=20))

```

