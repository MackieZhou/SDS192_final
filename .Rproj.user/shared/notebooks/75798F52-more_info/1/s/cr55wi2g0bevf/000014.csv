"0","# select only the state names and the percentages"
"0","Edu_percent <- Edu_complete %>%"
"0","  select(State, contains(""Percent"")) %>% "
"0","  select(-(contains(""MOE""))) %>% "
"0","  pivot_longer(names_to = ""Education"", "
"0","               values_to = ""Percentage"", "
"0","               cols = -State) %>% "
"0","  mutate(Education = str_replace_all(Education, "" - Percent"", """"))"
"0",""
"0","Edu_percent <- arrange(Edu_percent, Education, Percentage)"
"0","Edu_percent$State <- factor(Edu_percent$State, levels = unique(Edu_percent$State)) "
"0",""
"0","edu <- ggplot(data = Edu_percent, "
"0","       mapping = aes(x = State,"
"0","                     y = Percentage, "
"0","                     fill = factor(Education, "
"0","                                   levels=c(""Less than high school graduate"","
"0","                                            ""High school graduate (includes equivalency)"","
"0","                                            ""Some college or associate's degree"","
"0","                                            ""Bachelor's degree or higher"")))) +"
"0","  geom_bar(position=""fill"", "
"0","           stat=""identity"","
"0","           width = 0.7) +"
"0","  scale_y_continuous(labels = scales::percent) +"
"0","  labs(x = ""State"","
"0","       y = ""Percentage"","
"0","       fill = ""Educational Attainment"","
"0","       title = ""Estimate Educational Attainment\nof People Aged 18-24\nby States in 2017"") +"
"0","  coord_flip() +"
"0","  # theme(text = element_text(size=15)) +"
"0","  # guides(fill=guide_legend(ncol=1)) +"
"0","  guides(fill = guide_legend(reverse=TRUE, ncol=1)) +"
"0","  theme(legend.position=""bottom"")"
"0","# edu"
"0",""
"0",""
"0","#Education Attainment Map by State in U.S"
"0","edu_map_df<- US_map %>%"
"0","  left_join(Edu_complete,by=c(""name""=""State"")) %>%"
"0","  filter(stusps != ""DC"")"
"0",""
"0","edu_map <- ggplot()+"
"0","  geom_sf(data = edu_map_df, aes(fill = score), color = ""white"") +"
"0","  scale_fill_gradient(low = ""lightblue"","
"0","                      high = ""#06154f"") +"
"0","  coord_sf(xlim = c(-170, -60),"
"0","           ylim = c(24, 72),"
"0","           expand = FALSE) +"
"0","  labs(x = ""Longitude"", "
"0","       y = ""Latitude"", "
"0","       fill = ""Education\nLevel\nScore"","
"0","       title = ""Education Level Score by State"")"
"0","# edu_map"
"0",""
"0","layout <- """
"0","  AB"
"0","  A#"
"0","  A#"
"0","  A#"
"0","  A#"""
"0","  "
"0","edu + edu_map +"
"0","  plot_layout(design = layout)"
"0",""
